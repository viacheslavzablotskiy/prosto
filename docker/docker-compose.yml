version: "3.8"


services:

  db_1:
    image: postgres
    container_name: vlad
    env_file:
      - ../docker/env.dev
    volumes:
      - pgdata:/var/lib/postgresql/data/
  redis:
    image: "redis:alpine"

  celery:
    build: .
    command: celery -A  docker.docker.celery worker --loglevel=INFO
    volumes:
      - .:/gost/gost_2/gost_3/docker/
    links:
      - 'db_1: 127.0.0.1'
    env_file:
      - ../docker/env.dev
    depends_on:
      - django
      - redis

  django:
    build: .
    restart: always
    container_name: django_room
    command: python docker/manage.py runserver 0.0.0.0:8000
    volumes:
      - .:/gost/gost_2/gost_3/docker/
    ports:
      - "8000:8000"
    env_file:
     - ../docker/env.dev
    links:
      - "db_1: 127.0.0.1"
    depends_on:
      - db_1
      - redis

volumes:
  pgdata: